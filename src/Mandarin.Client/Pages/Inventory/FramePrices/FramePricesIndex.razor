@page "/inventory/frame-prices"
@using System.Reactive.Linq
@inherits ReactiveInjectableComponentBase<IFramePricesIndexViewModel>

<Card>
  <CardHeader>
    <CardTitle>Frame Prices</CardTitle>
    <CardActions Float="Float.Right">
      <ReactiveButton ReactiveCommand="@ViewModel!.EditSelected" Color="Color.Secondary">Edit</ReactiveButton>
      <ReactiveButton ReactiveCommand="@ViewModel!.CreateNew" Color="Color.Primary">New</ReactiveButton>
    </CardActions>
  </CardHeader>
  <CardBody>
    @if (ViewModel!.IsLoading)
    {
      <MandarinProgressBar>Loading Data...</MandarinProgressBar>
    }
    else
    {
      <DataGrid TItem="IFramePriceGridRowViewModel" Data="@ViewModel!.Rows" Filterable="true" Striped="true"
                ShowPager="true" PagerPosition="DataGridPagerPosition.Top" PageSize="15"
                RowSelectable="@(_ => true)" @bind-SelectedRow="@ViewModel!.SelectedRow">
        <DataGridColumn TItem="IFramePriceGridRowViewModel" Caption="Product Code" Field="@(nameof(IFramePriceGridRowViewModel.ProductCode))" TextAlignment="TextAlignment.Left" />
        <DataGridColumn TItem="IFramePriceGridRowViewModel" Caption="Product Name" Field="@(nameof(IFramePriceGridRowViewModel.ProductName))" TextAlignment="TextAlignment.Left" />
        <DataGridNumericColumn TItem="IFramePriceGridRowViewModel" Caption="Retail Price" Field="@(nameof(IFramePriceGridRowViewModel.RetailPrice))" TextAlignment="TextAlignment.Right" DisplayFormat="{0:C}" />
        <DataGridNumericColumn TItem="IFramePriceGridRowViewModel" Caption="Frame Price" Field="@(nameof(IFramePriceGridRowViewModel.FramePrice))" TextAlignment="TextAlignment.Right" DisplayFormat="{0:C}" />
        <DataGridNumericColumn TItem="IFramePriceGridRowViewModel" Caption="Artist Price" Field="@(nameof(IFramePriceGridRowViewModel.ArtistPrice))" TextAlignment="TextAlignment.Right" DisplayFormat="{0:C}" />
      </DataGrid>
    }
  </CardBody>
</Card>

@code {

  /// <inheritdoc />
  protected override async Task OnInitializedAsync()
  {
    await base.OnInitializedAsync();
    await ViewModel!.LoadData.Execute();
  }

}
